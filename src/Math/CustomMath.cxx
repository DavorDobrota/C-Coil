#include "CustomMath.h"

#include <cmath>
#include <cstdint>
#include <cstring>

#include <immintrin.h>

const double
customMath::taylorWeightsLn[] = {1.09861228866810978211, 0.33333333333333331483, -0.055555555555555552472,
                                 0.012345679012345678327, -0.0030864197530864195818, 0.00082304526748971191738,
                                 -0.00022862368541380886293, 6.53210529753739589e-05, -1.905197378448407304e-05,
                                 5.6450292694767621626e-06, -1.6935087808430286488e-06, 5.1318447904334197628e-07,
                                 -1.5680636859657673262e-07, 4.8248113414331303872e-08, -1.4933939866340640099e-08,
                                 4.6461146250837549549e-09, -1.45191082033867332e-09, 4.5550143383174067577e-10,
                                 -1.4339859953962206747e-10, 4.5283768275670128609e-11, -1.433985995396220707e-11,
                                 4.5523364933213352186e-12, -1.4484707024204249708e-12, 4.6183123845288911381e-13,
                                 -1.4752942339467290434e-13, 4.72094154862953304e-14, -1.5131222912274144035e-14,
                                 4.8569357496188614282e-15, -1.5611579195203482035e-15, 5.0244162927091664506e-16};

const double
customMath::taylorWeightsCos[] = {0.16666666666666665741, -0.0083333333333333332177, 0.00019841269841269841253,
                                  -2.7557319223985892511e-06, 2.5052108385441720224e-08, -1.6059043836821613341e-10,
                                  7.6471637318198164055e-13, -2.8114572543455205981e-15, 8.2206352466243294955e-18};

//    printf("{");
//    for (int i = 0; i < 160; ++i)
//    {
//        double centerValue = 2 + (i + 0.5) * 0.0125;
//        printf("{");
//        printf("%.20g", std::log(centerValue));
//
//        double potValue = centerValue;
//        for (int j = 1; j <= 5; ++j)
//        {
//            printf(", ");
//            if (j % 2 == 0)
//                printf("-");
//            printf("%.20g", (1.0 / potValue) * (1.0 / j));
//            potValue *= centerValue;
//        }
//        printf("},\n");
//    }
//    printf("}");

const double
customMath::taylorTableLn[160][6] =  {{0.69626730789618895834, 0.49844236760124610575, -0.12422239690996786377, 0.04127847041660406141, -0.015431203894057592824, 0.0061532526431133088146},
                                      {0.70247850798882949253, 0.49535603715170284378, -0.12268880177131960552, 0.040516425765554468785, -0.015052542080082158271, 0.0059650940750789992195},
                                      {0.70865136709591058928, 0.49230769230769233502, -0.12118343195266272072, 0.039773023820361096126, -0.014685424179825636026, 0.0057837978308236358271},
                                      {0.7147863556634265203, 0.48929663608562684596, -0.11970559904235518467, 0.039047697954692817124, -0.014329430442089107281, 0.0056090736898697420715},
                                      {0.72088393553154495041, 0.4863221884498480363, -0.1182546354893247581, 0.038339902083671648092, -0.013984158814713066113, 0.0054406453747211933406},
                                      {0.72694456014323605153, 0.48338368580060420143, -0.11682989384908862296, 0.03764910980031052623, -0.013649224096789315877, 0.0052782498017795546896},
                                      {0.73296867474661686614, 0.48048048048048053182, -0.11543074606137671001, 0.036974813553193743021, -0.013324257136286037084, 0.0051216363767105496305},
                                      {0.73895671659123951525, 0.47761194029850745357, -0.1140565827578525343, 0.036316523863196822908, -0.013008904070398862041, 0.0049705663313762823638},
                                      {0.74490911511853485916, 0.474777448071216579, -0.1127068125985083713, 0.035673768577173761707, -0.01270282560611528562,0.0048248120996520968418},
                                      {0.75082629214662333084, 0.4719764011799409964, -0.11138086163538432616, 0.035046092156659769401, -0.012405696338640626736, 0.004684156729634219446},
                                      {0.75670866204968989521, 0.4692082111436949865, -0.11007817270233312412, 0.034433054999752292502, -0.012117204105484677759, 0.0045483933299180021731},
                                      {0.76255663193211287165, 0.4664723032069971187, -0.10879820482962032635, 0.033834232794439755843, -0.011837049374148020386, 0.0044173245477870165185},
                                      {0.76837060179753280398, 0.46376811594202899114, -0.10754043268220961349, 0.033249215901745968194, -0.011564944661476858276, 0.0042907620773015592991},
                                      {0.77415096471303235237, 0.4610951008645532978, -0.10630434602064628424, 0.032677608767153511204, -0.011300613982877294461, 0.0041685261954129502332},
                                      {0.77989810696860017991, 0.4584527220630372768, -0.10508944918350424103, 0.032119029358855161194, -0.011043792329692320511, 0.0040504453243570695889},
                                      {0.78561240823203892791, 0.45584045584045584931, -0.10389526059041728767, 0.031573108631465840457, -0.010794225173150715294, 0.0039363556186988359759},
                                      {0.79129424169946971368, 0.45325779036827201773, -0.10272131226476420574, 0.03103949001390420015, -0.010551667993395196649, 0.0038261005755087403035},
                                      {0.79694397424158891496, 0.45070422535211268622, -0.10156714937512398289, 0.030517828920225045786, -0.0103158858321887488, 0.0037195306662539716694},
                                      {0.80256196654581224426, 0.44817927170868343545, -0.1004323297946629473, 0.030007792282252230415, -0.010086652867983943171, 0.0036165029890810776285},
                                      {0.80814857325445188518, 0.44568245125348193714, -0.099316423677656140434, 0.029509058102924760197, -0.0098637520121196958084, 0.0035168809402543765343},
                                      {0.81370414309905403361, 0.44321329639889195384, -0.098219013052386033857, 0.029021315029329204649, -0.0096469745249847770052, 0.003420533903595710315},
                                      {0.81922901903102374188, 0.4407713498622589654, -0.097139691429698957204, 0.028544261944447812951, -0.0094361196510571281049, 0.003327336956846591292},
                                      {0.82472353834866463096, 0.4383561643835616195, -0.096078063426534063285, 0.028077607576704015357, -0.0092309942717931012246, 0.0032371705939438820757},
                                      {0.83018803282074338235, 0.43596730245231601897, -0.095033744403774614296, 0.0276210701264376704, -0.0090314125754019630027, 0.0031499204622655340748},
                                      {0.83562282880670024632, 0.43360433604336046098, -0.094006360117801723852, 0.027174376908488305504, -0.0088371957425978225897, 0.0030654771139634728189},
                                      {0.84102824737360826202, 0.43126684636118595151, -0.092995546385161387271, 0.026737264010109292045, -0.0086481716474747036966, 0.0029837357705573101796},
                                      {0.84640460440998854796, 0.42895442359249330577, -0.09200094875978409581, 0.026309475963477133714, -0.0084641745727004197297, 0.0029045961000151582221},
                                      {0.85175221073658391457, 0.42666666666666669405, -0.091022222222222226584, 0.025890765432098762633, -0.0082850449382716045976, 0.0028279620055967078299},
                                      {0.85707137221418394635, 0.42440318302387264326, -0.090059030880397378249, 0.02548089291045725624, -0.0081106290431163675231, 0.0027537414257795623032},
                                      {0.86236238984859936441, 0.422163588390501332, -0.089111047681372318463, 0.025079626436270131828, -0.0079407788188718114036, 0.0026818461446321685375},
                                      {0.86762555989287404312, 0.4199475065616797842, -0.088177954133686037297, 0.024686741314767741279, -0.0077753515952024383415, 0.0026121916120365146034},
                                      {0.87286117394681894677, 0.41775456919060055538, -0.087259440039812133372, 0.024302019854429840473, -0.0076142098760615690295, 0.0025446967732007338449},
                                      {0.87806951905395724811, 0.41558441558441561181, -0.086355203238320119019, 0.023925251113647131446, -0.0074572211263315736629, 0.002479283906936211989},
                                      {0.88325087779595490289, 0.41343669250645992408, -0.085464949355340547044, 0.023556230657802729872, -0.0073042575683109232584, 0.0024158784722061970966},
                                      {0.88840552838461928076, 0.41131105398457584732, -0.0845883915649513346, 0.023194760326293424602, -0.0071551959875455302049, 0.002354408962482848304},
                                      {0.89353374475153890533, 0.409207161125319685, -0.083725250358121672267, 0.022840648009035742494, -0.0070099175475301523514, 0.0022948067674779014727},
                                      {0.89863579663543424747, 0.40712468193384226955, -0.082875253319866115653, 0.022493707432024730164, -0.0068683076128319801856, 0.0022370060418384057205},
                                      {0.9037119496672949559, 0.40506329113924050001, -0.082038134914276555909, 0.022153757951534597259, -0.0067302555802130426335, 0.0021809435804234669591},
                                      {0.90876246545336358817, 0.40302267002518887828, -0.081213636277116141304, 0.021820624356571925034, -0.0065956547173517164964, 0.0021265586998010571271},
                                      {0.91378760165603645227, 0.40100250626566419365, -0.080401505015672017351, 0.021494136679210563284, -0.0064644020087851316453, 0.0020737931256253057215},
                                      {0.91878761207274228795, 0.39900249376558599712, -0.079601495015578255243, 0.021174130012456389427, -0.006336398008715129343, 0.0020225908855749040981},
                                      {0.9237627467128559644, 0.39702233250620350136, -0.078813366254333216965, 0.020860444335307384844, -0.0062115467003396682838, 0.0019728982075520539417},
                                      {0.92871325187271225321, 0.39506172839506170646, -0.078036884621246763172, 0.020552924344690505498, -0.0060897553613897788607, 0.0019246634228589920308},
                                      {0.93363937020876808237, 0.3931203931203930968, -0.077271821743566199148, 0.020251419293973123292, -0.0059709344355694717738, 0.00187783687408573036},
                                      {0.93854134080897477777, 0.39119804400977997716, -0.076517954818538874706, 0.019955782837760747961, -0.0058549974096119561384, 0.0018323708274580207712},
                                      {0.94341939926240769854, 0.38929440389294400759, -0.075775066451181316562, 0.019665872882707234603, -0.0057418606956809439476, 0.0017882193894091507214},
                                      {0.94827377772720577997, 0.38740920096852304866, -0.075042944497534735948, 0.019381551444076765278, -0.0056314435188600780319, 0.0017453384271527601357},
                                      {0.95310470499687138801, 0.38554216867469881524, -0.074321381913194942137, 0.019102684507809143677, -0.0055236678094869812519, 0.0017036854930465869865},
                                      {0.95791240656497456119, 0.38369304556354916214, -0.073610176606915891928, 0.018829141897852182119, -0.0054184581001013483459, 0.0016632197525490947237},
                                      {0.96269710468831082295, 0.38186157517899760316, -0.072909131299092627687, 0.018560797148535909673, -0.0053157414267883283318, 0.0016239019155821149756},
                                      {0.96745901844855453078, 0.38004750593824226934, -0.072218053384939140393, 0.018297527381773967536, -0.0052154472347099205612, 0.0015856941711232062225},
                                      {0.97219836381245094969, 0.37825059101654850968, -0.071536754802184118751, 0.018039213188888035544, -0.005117507287627811631, 0.001548560124861371283},
                                      {0.9769153536905899049, 0.37647058823529411242, -0.070865051903114192888, 0.017785738516860029323, -0.0050218555812310680317, 0.0015124647397590038761},
                                      {0.9816101979947976508, 0.37470725995316156443, -0.070202765330803107435, 0.017536990558826692083, -0.0049284282600918103909, 0.0014773742793717840015},
                                      {0.98628310369419003312, 0.37296037296037298781, -0.069549719899370254783, 0.017292859648639066772, -0.0048371635380808587421, 0.0014432562537863634182},
                                      {0.99093427486992091691, 0.37122969837587005415, -0.068905744478119729246, 0.017053239159318105134, -0.0047480016220839277308, 0.0014100793680434865925},
                                      {0.99556391276866285089, 0.3695150115473441188, -0.068270671879416933159, 0.016818025405245129456, -0.0046608846388670101962, 0.0013778134729214258462},
                                      {1.0001722158548571606, 0.3678160919540229834, -0.06764433875016515052, 0.016587117547933214606, -0.0045757565649470937144, 0.0013464295179614438162},
                                      {1.0047593798617633354, 0.36613272311212813337, -0.067026585466751137377, 0.016360417505232920099, -0.0044925631593316943044, 0.0013158995066234711879},
                                      {1.0093255978413444574, 0.36446469248291574194, -0.066417256033333163523, 0.016137829863831901211, -0.0044112518989973311528, 0.0012861964534661924145},
                                      {1.013871060213019204, 0.36281179138321995037, -0.065816197983350546719, 0.015919261794914721375, -0.0043317719169835974466, 0.0012572943432514751497},
                                      {1.0183959548113086235, 0.36117381489841987596, -0.065223262284139035816, 0.01570462297285514508, -0.0042540739429855929654, 0.001229168091878456116},
                                      {1.0229004669324133214, 0.35955056179775279901, -0.064638303244539827008, 0.015493825496818535228, -0.0041781102463330881125, 0.0012017935090576075275},
                                      {1.0273847793797419303, 0.35794183445190153048, -0.064061178425396242408, 0.015286783815157941116, -0.0041038345812504537988, 0.001175147262639951104},
                                      {1.0318490725084272785, 0.35634743875278396263, -0.063491748552834570418, 0.015083414652492251051, -0.0040312021342963702542, 0.0011492068445210143739},
                                      {1.0362935242688513515, 0.35476718403547669034, -0.062929877434230896416, 0.014883636939359855961, -0.0039601694738873238419, 0.0011239505380434089508},
                                      {1.0407183102492070237, 0.35320088300220753297, -0.062375431876769547868, 0.014687371744346030406, -0.003890694501813518353, 0.0010993573868258951255},
                                      {1.0451236037171234283, 0.3516483516483516758, -0.06182828160850138699, 0.014494542208586405976, -0.0038227364066601510553, 0.0010754071649505480245},
                                      {1.0495095756603778359, 0.35010940919037197849, -0.061288299201815658879, 0.014305073482553616604, -0.0037562556190512776978, 0.0010520803484432464207},
                                      {1.0538763948267182435, 0.34858387799564272136, -0.060755359999240560187, 0.014118892665037748035, -0.0036912137686373196373, 0.0010293580879860064672},
                                      {1.0582242277628215454, 0.34707158351409977959, -0.060229342041492370252, 0.013935928744235397472, -0.0036275736427510800464, 0.0010072221828029029149},
                                      {1.0625532388524070448, 0.34557235421166310196, -0.059710125997695574773, 0.01375611254086579055, -0.0035652991466606806341, 0.00098565505566429196388},
                                      {1.0668635903535292897, 0.34408602150537637154, -0.059197595097699153011, 0.013579376653235646771, -0.0035043552653511349584, 0.00096463972895687163586},
                                      {1.0711554424350704373, 0.3426124197002141103, -0.058691635066417828515, 0.01340565540417823151, -0.0034447080267695669165, 0.00094415980176981706678},
                                      {1.0754289532124523543, 0.34115138592750532398, -0.058192134060128852813, 0.01323488478979476142, -0.0033863244664720073066, 0.00092419942794971635981},
                                      {1.0796842787825908783, 0.3397027600849256701, -0.057698982604658284601, 0.013067002429929686774, -0.0033291725936126594955, 0.00090474329507944878468},
                                      {1.0839215732581060081, 0.33826638477801268534, -0.057212073535393280499, 0.012901947520314200127, -0.0032732213582192478708, 0.00088577660433840116512},
                                      {1.0881409888008142239, 0.33684210526315788714, -0.05673130193905816937, 0.012739660786314815216, -0.0032184406197005854811, 0.0008672850512035263108},
                                      {1.0923426756545142613, 0.3354297693920335055, -0.056256565097196391256, 0.012580084438227003354, -0.0031648011165350954481, 0.00084925480695281394764},
                                      {1.0965267821770883216, 0.33402922755741126792, -0.055787762431300423616, 0.012423162128055765391, -0.0031122744370912151617, 0.00083167250093460454944},
                                      {1.1006934548719342626, 0.33264033264033260329, -0.05532479544953557149, 0.012268838907727914328, -0.0030608329915329519737, 0.00081452520356802048454},
                                      {1.104842838418745643, 0.3312629399585921286, -0.054867567695004913764, 0.012117061188682935746, -0.0030104499847659464164, 0.00079780041004149325739},
                                      {1.1089750757036562767, 0.32989690721649483907, -0.0544159846955043075, 0.01196777670279132455, -0.0029610993903813587723, 0.00078148602467796677434},
                                      {1.1130903078487628388, 0.32854209445585214056, -0.053969953914719037691, 0.011820934464551737311, -0.0029127559255568966946, 0.00076557034593692551219},
                                      {1.1171886742410452875, 0.3271983640081799205, -0.053529384704814705898, 0.011676484734519905831, -0.0028653950268760506118, 0.00075004205202481482109},
                                      {1.1212703125606937604, 0.32586558044806518408, -0.053094188260377220279, 0.011534378983924446771, -0.0028189928270283778379, 0.00073489018708682756278},
                                      {1.1253353588088630399, 0.3245436105476673383, -0.05266427757365799156, 0.011394569860426341512, -0.0027735261323552961102, 0.00072010414795431638979},
                                      {1.1293839473348634694, 0.3232323232323232598, -0.052239567391082541992, 0.011257011154980749515, -0.0027289724012074544936, 0.00070567367142334181535},
                                      {1.133416210862801865, 0.32193158953722333937, -0.051819974170981622508, 0.011121657769761312054, -0.0026853097230812024258, 0.00069158882204103401797},
                                      {1.1374322805176919626, 0.32064128256513024784, -0.051405416042505841512, 0.010988465687108792818, -0.0026425167985031166283, 0.00067783998037755296973},
                                      {1.1414322858510379533, 0.31936127744510978133, -0.050995812765686189538, 0.010857391939467450973, -0.0026005729196329225444, 0.00066441783176250310272},
                                      {1.1454163548659122007, 0.31809145129224652981, -0.050591085692603829371, 0.010728394580273839867, -0.0025594579515563833927, 0.00065131335546564036489},
                                      {1.1493846140415329149, 0.31683168316831683553, -0.05019115772963434613, 0.010601432655764349983, -0.0025191523142410339985, 0.00063851781430267792565},
                                      {1.1533371883573562133, 0.31558185404339250679, -0.049795953300732540003, 0.010476466177668907614, -0.0024796369651287359509, 0.00062602274464788594619},
                                      {1.1572742013166958941, 0.31434184675834969669, -0.049405398311724899041, 0.010353456096759637226, -0.0024408933823401894256, 0.00061381994683603973394},
                                      {1.161195774969877581, 0.31311154598825829964, -0.049019420115578603292, 0.010232364277224494098, -0.002402903548467591726, 0.00060190147593708765578},
                                      {1.1651020299369425626, 0.31189083820662771851, -0.048637947478616411212, 0.010113153471837069142, -0.0023656499349326478437, 0.00059025963288767834165},
                                      {1.1689930854299093177, 0.31067961165048540995, -0.048260910547648222524, 0.0099957872978947773235, -0.0023291154868881037109, 0.00057888695596442190771},
                                      {1.1728690592746022769, 0.30947775628626689182, -0.047888240817991006848, 0.009880230213898852018, -0.0022932836086419000274, 0.00056777621258445501017},
                                      {1.1767300679320618073, 0.30828516377649323177, -0.047519871102349627023, 0.00976644749695046617, -0.0022581381495839227512, 0.00055692039141954155501},
                                      {1.180576226519540084, 0.30710172744721686566, -0.047155735500532341975, 0.0096544052208383523972, -0.0022236633905961659431, 0.00054631269481057427931},
                                      {1.1844076488310959494, 0.30592734225621415201, -0.046795769369975405427, 0.0095440702347942187739, -0.0021898440309279280057, 0.00053594653146993276836},
                                      {1.1882244473577967536, 0.3047619047619047894, -0.046439909297052155146, 0.009435410142893136537, -0.0021566651755184312704, 0.000525815509459731786},
                                      {1.192026733307535391, 0.30360531309297911218, -0.046088093069142938019, 0.0093283932840770005662, -0.0021241123227499813034, 0.00051591342943453058403},
                                      {1.1958146166244725261, 0.30245746691871450151, -0.045740259647442639557, 0.0092229887127798643176, -0.0020921713526154701174, 0.00050623427813758061292},
                                      {1.1995882060081120013, 0.30131826741996231567, -0.045396349140483967244, 0.0091191661801348841698, -0.002060828515284719633, 0.00049677222214019602867},
                                      {1.2033476089320176428, 0.30018761726078801999, -0.045056302778354671845, 0.0090168961157432742787, -0.0020300704200547710528, 0.00048752160181427905798},
                                      {1.2070929316621796801, 0.29906542056074764124, -0.044720062887588438172, 0.0089161496099864796794, -0.0019998840246698646253, 0.00047847692552849100962},
                                      {1.2108242792750378847, 0.29795158286778394841, -0.044387572866708968622, 0.0088168983968633547754, -0.0019702566249973976764, 0.00046963286405897009066},
                                      {1.2145417556751703092, 0.29684601113172537357, -0.044058777162408219175, 0.0087191148373349583456, -0.0019411758450467440137, 0.00046098424520590582185},
                                      {1.2182454636126547332, 0.29574861367837335102, -0.043733621246339872413, 0.0086227719031600480459, -0.0019126296273183102537, 0.00045252604860765937135},
                                      {1.2219355047001083658, 0.29465930018416208735, -0.043412051592510068898, 0.008527843161205169234, -0.0018846062234707558307, 0.00044425340074448753814},
                                      {1.225611979429417131, 0.29357798165137616309, -0.043094015655247876195, 0.0084343027582136510106, -0.0018570941852947488344, 0.00043616157012427137461},
                                      {1.2292749871881543111, 0.29250457038391225462, -0.042779461847738536884, 0.0083421254060184833051, -0.0018300823559821170674, 0.00042824596264298166182},
                                      {1.2329246262757038721, 0.2914389799635700995, -0.042468339521103105894, 0.0082512863671845727148, -0.0018035598616796878237, 0.00042050211711293269392},
                                      {1.236560993919087581, 0.29038112522686027051, -0.042160598944008746691, 0.008161761441066422984, -0.0017775161033175513811, 0.00041292570095217170749},
                                      {1.240184186288507906, 0.28933092224231465872, -0.04185619128279416401, 0.0080735269502677110137, -0.001751940748701854211, 0.00040551250602863892977},
                                      {1.2437942985126075879, 0.28828828828828828579, -0.041555068582095608387, 0.0079865597274898468549, -0.0017268237248626696137, 0.00039825844465301213143},
                                      {1.247391424693457207, 0.28725314183123878964, -0.041257183745958887766, 0.0079008371027569374717, -0.0017021552106478139797, 0.00039115954571439888118},
                                      {1.2509756579212722993, 0.2862254025044722594, -0.040962490519423570834, 0.0078163368910050927407, -0.0016779256295538656687, 0.00038421195095330023389},
                                      {1.2545470902888693487, 0.2852049910873440397, -0.040670943470565990019, 0.0077330373800244310914, -0.0016541256427859746172, 0.0003774119113664968321},
                                      {1.2581058129058633188, 0.28419182948490234741, -0.040382497972987901891, 0.0076509173187425272983, -0.0016307461425383719227, 0.00037075578373874183008},
                                      {1.2616519159126140526, 0.28318584070796459784, -0.040097110188738349645, 0.007569955905838508109, -0.001607778245487824758, 0.00036424002729635679377},
                                      {1.2651854884939250923, 0.28218694885361550462, -0.039814737051656508282, 0.0074901327786772962936, -0.0015852132864925493321, 0.00035786120047803576458},
                                      {1.2687066188925040233, 0.28119507908611596214, -0.039535336251123508189, 0.0074114280025539078928, -0.0015630428124894005758, 0.000351615957818353711},
                                      {1.2722153944221832322, 0.28021015761821366219, -0.039258866216212065514, 0.0073338220602380968863, -0.0015412585765824371713, 0.00034550104693967069458},
                                      {1.2757119014809126245, 0.27923211169284467559, -0.038985286100222650563, 0.007257295841809917325, -0.0015198525323162131659, 0.00033951330564829893411},
                                      {1.2791962255635234147, 0.27826086956521739468, -0.038714555765595459746, 0.0071818306347771285886, -0.0014988168281274008922, 0.00033364965913096930432},
                                      {1.2826684512742727584, 0.27729636048526862258, -0.038446635769188018672, 0.0071074081144657224457, -0.0014781438019686077463, 0.00032790711724780207369},
                                      {1.2861286623391683381, 0.27633851468048353794, -0.038181487347907910879, 0.0070340103346750318739, -0.0014578259760984521153, 0.00032228277191813798621},
                                      {1.2895769416180842271, 0.27538726333907054267, -0.037919072404691299416, 0.0069616197185893369595, -0.0014378560520322211397, 0.00031677379459573893564},
                                      {1.2930133711166653665, 0.27444253859348199942, -0.037659353494817429664, 0.0068902190499380089675, -0.0014182269056476175251, 0.00031137743383000869796},
                                      {1.2964380319980295386, 0.27350427350427353179, -0.037402293812550224672, 0.0068197914643966213791, -0.0013989315824403326851, 0.00030609101291002150215},
                                      {1.299851004594269499, 0.27257240204429300512, -0.037147857178097848374, 0.006750320441221641446, -0.0013799632929243561049, 0.00030091192758827529355},
                                      {1.3032523684177599321, 0.27164685908319180507, -0.03689600802488174347, 0.0066817897951115760163, -0.0013613154081721376767, 0.00029583764388121160669},
                                      {1.3066422021722712277, 0.27072758037225042038, -0.036646711387106657709, 0.00661418366828772121, -0.0013429814554898925841, 0.00029086569594366539545},
                                      {1.3100205837638985162, 0.2698145025295109467, -0.036399932887623741296, 0.006547486522787856339, -0.0013249551142235124323, 0.00028599368401451870239},
                                      {1.313387590311802855, 0.26890756302521007237, -0.036155638726078666301, 0.0064816831329664835459, -0.0013072302116907193615, 0.00028121927243094469806},
                                      {1.3167432981587752217, 0.2680067001675041638, -0.03591379566733724632, 0.0064167585781953750956, -0.001289800719235251452, 0.00027654018770873059008},
                                      {1.3200877828816224291, 0.26711185308848078845, -0.035674371030181069309, 0.0063526982357584530631, -0.0012726607483990223357, 0.00027195421668626851589},
                                      {1.3234211193013807328, 0.26622296173044923684, -0.035437332676266121434, 0.0062894877739351953, -0.0012558045472083586083, 0.00026745920472990002701},
                                      {1.3267433814933584646, 0.26533996683250415938, -0.035202648999337206315, 0.0062271131452669454404, -0.0012392264965705365991, 0.00026305305399838921918},
                                      {1.3300546427970145746, 0.26446280991735537924, -0.034970288914691616267, 0.0061655605800007258835, -0.0012229211067770035491, 0.00025873372176439085298},
                                      {1.3333549758256713069, 0.26359143327841844107, -0.034740221848885463607, 0.0061048165797052975426, -0.0012068830141097786242, 0.00025449921879085944361},
                                      {1.3366444524760701107, 0.26272577996715923421, -0.034512417729676087008, 0.0060448679110543775475, -0.0011911069775476603762, 0.00025034760776042780687},
                                      {1.3399231439377683461, 0.26186579378068741697, -0.034286846976194745862, 0.0059857015997721325223, -0.001175587875568994984, 0.00024627700175586144781},
                                      {1.3431911207023843335, 0.26101141924959220253, -0.034063480489343191115, 0.0059273049247361717443, -0.0011603207030478641243, 0.00024228556278976608575},
                                      {1.3464484525726909681, 0.26016260162601628769, -0.033842289642408616979, 0.005869665412233473524, -0.0011453005682406777396, 0.00023837150038179960587},
                                      {1.3496952086715610086, 0.25931928687196109662, -0.033623246271891227277, 0.0058127708303647700888, -0.0011305226898602471763, 0.0002345330701817044275},
                                      {1.3529314574507693703, 0.25848142164781906516, -0.033406322668538809828, 0.005756609183593116609, -0.0011159823942345299588, 0.00023076857263654252392},
                                      {1.3561572666996519754, 0.25764895330112719263, -0.033191491568583211813, 0.0057011687074324359295, -0.0011016751125473307066, 0.00022707635170057701964},
                                      {1.3593727035536262715, 0.25682182985553775323, -0.032978726145173387074, 0.005646437863272062152, -0.0010875963781583426662, 0.00022345479358630476242},
                                      {1.3625778345025745253, 0.25600000000000000533, -0.032767999999999998517, 0.0055924053333333331034, -0.0010737418239999999784, 0.00021990232555520002251},
                                      {1.3657727253990938898, 0.25518341307814990104, -0.032559287155106843292, 0.0055390600157544864213, -0.0010601071800487055653, 0.00021641741474678519944},
                                      {1.3689574414666136892, 0.25437201907790141231, -0.032352562044884118631, 0.0054863910198001668989, -0.0010466882708680764948, 0.00021299856704469597064},
                                      {1.3721320473073863599, 0.2535657686212361428, -0.032147799508239129074, 0.0054343876611920340081, -0.0010334810132219399755, 0.00020964432597846008668},
                                      {1.375296606910349162, 0.2527646129541864517, -0.031944974780939834613, 0.0053830394575570018889, -0.0010204814137548820843, 0.00020635327165975498828},
                                      {1.3784511836588646538, 0.25196850393700787052, -0.031744063488126979256, 0.0053323361239898331779, -0.0010076855667382361194, 0.00020312401975195942881},
                                      {1.3815958403383363784, 0.25117739403453687164, -0.031545041636990497902, 0.0052822675687268236602, -0.00099508965187946425354, 0.00019995522047185467288},
                                      {1.3847306391437079753, 0.25039123630672921461, -0.031347885609606163104, 0.0052328238889274751935, -0.00098268993219295295259, 0.00019684555762237553739}};




double customMath::ln(double x)
{
    uint64_t xBits;
    double x1;
    int exponent;
    // basic principle, ln(a) = ln(b * 2^n) = ln(b) + n * ln(2), b element [2.0, 4.0], a is positive
    // converting double to an int so bitwise operations can be performed
    std::memcpy(&xBits, &x, sizeof(x));
    // extracting the exponent bits and manipulating them to their final form
    unsigned long long exp = xBits & 0x7ff0000000000000;
    exp >>= 52;
    exp -= 1024;
    exponent = (int) exp;
    // changing the exponent so all numbers land in [2.0, 4.0]
    xBits &= 0x400fffffffffffff;
    xBits |= 0x4000000000000000;
    // converting the altered number back to double
    std::memcpy(&x1, &xBits, sizeof(xBits));

    double output = exponent * 0.69314718055994528623;

    int row = (int) ((x1 - 2.0) * 80.0);
    x1 -= (2 + (row + 0.5) * 0.0125);

    double x2 = x1 * x1;
    double x4 = x2 * x2;

    output += taylorTableLn[row][0] + taylorTableLn[row][1] * x1;
    output += taylorTableLn[row][2] * x2 + taylorTableLn[row][3] * x2 * x1;
    output += taylorTableLn[row][4] * x4 + taylorTableLn[row][5] * x4 * x1;

//    double x2 = x1 * x1;
//    double x3 = x1 * x2;
//    double x4 = x2 * x2;
//    double x5 = x2 * x3;
//
//    __m256d inputVector1, inputVector2;
//    __m256d outputVector;
//    double outAr[4];
//
//    inputVector1 = _mm256_set_pd(x2, x4, x5, 0.0);
//    inputVector2 = _mm256_set_pd(x4, x4, x5, 0.0);
//    _mm256_storeu_pd(outAr, outputVector);
//
//    double x6 = outAr[0];
//    double x8 = outAr[1];
//    double x10 = outAr[2];
//
//    double x7 = x1 * x6;
//
//    inputVector1 = _mm256_set_pd(x4, x5, x6, x10);
//    inputVector2 = inputVector1;
//    outputVector = _mm256_mul_pd(inputVector1, inputVector2);
//    _mm256_storeu_pd(outAr, outputVector);
//
//    double x12 = outAr[0];
//    double x16 = outAr[1];
//    double x20 = outAr[2];
//    double x24 = outAr[3];
//
//    output += taylorWeightsLn[0] + taylorWeightsLn[1] * x1;
//    output += taylorWeightsLn[2] * x2 + taylorWeightsLn[3] * x3;
//    output += taylorWeightsLn[4] * x4 + taylorWeightsLn[5] * x5;
//    output += taylorWeightsLn[6] * x6 + taylorWeightsLn[7] * x7;
//    output += taylorWeightsLn[8] * x8 + taylorWeightsLn[9] * x1 * x8;
//    output += taylorWeightsLn[10] * x10 + taylorWeightsLn[11] * x1 * x10;
//    output += taylorWeightsLn[12] * x12 + + taylorWeightsLn[13] * x1 * x12;
//    output += taylorWeightsLn[14] * x2 * x12 + taylorWeightsLn[15] * x3 * x12;
//    output += taylorWeightsLn[16] * x16 + taylorWeightsLn[17] * x1 * x16;
//    output += taylorWeightsLn[18] * x2 * x16 + taylorWeightsLn[19] * x3 * x16;
//    output += taylorWeightsLn[20] * x20 + taylorWeightsLn[21] * x1 * x20;
//    output += taylorWeightsLn[22] * x2 * x20 + taylorWeightsLn[23] * x3 * x20;
//    output += taylorWeightsLn[24] * x24 + taylorWeightsLn[25] * x1 * x24;
//    output += taylorWeightsLn[26] * x2 * x24 + taylorWeightsLn[27] * x3 * x24;
//    output += taylorWeightsLn[28] * x4 * x24 + taylorWeightsLn[29] * x5 * x24;

    return output;
}

double customMath::cos(double x)
{
    double x1 = x - M_PI_2;
    double output = 0.0;

    double x2 = x1 * x1;
    double x3 = x1 * x2;
    double x5 = x3 * x2;
    double x7 = x5 * x2;
    double x9 = x7 * x2;
    double x11 = x9 * x2;
    double x13 = x11 * x2;
    double x15 = x13 * x2;
    double x17 = x15 * x2;

    output += -x1 + taylorWeightsCos[0] * x3;
    output += taylorWeightsCos[1] * x5 + taylorWeightsCos[2] * x7;
    output += taylorWeightsCos[3] * x9 + taylorWeightsCos[4] * x11;
    output += taylorWeightsCos[5] * x13 + taylorWeightsCos[6] * x15;
    output += taylorWeightsCos[7] * x17 + taylorWeightsCos[8] * x17 * x2;

    return output;
}

float customMath::lnf(float x)
{
    auto xd = (double) x;
    uint64_t xBits;
    double x1;
    int exponent;
    // basic principle, ln(a) = ln(b * 2^n) = ln(b) + n * ln(2), b element [2.0, 4.0], a is positive
    // converting double to an int so bitwise operations can be performed
    std::memcpy(&xBits, &xd, sizeof(xd));
    // extracting the exponent bits and manipulating them to their final form
    unsigned long long exp = xBits & 0x7ff0000000000000;
    exp >>= 52;
    exp -= 1024;
    exponent = (int) exp;
    // changing the exponent so all numbers land in [2.0, 4.0]
    xBits &= 0x400fffffffffffff;
    xBits |= 0x4000000000000000;
    // converting the altered number back to double
    std::memcpy(&x1, &xBits, sizeof(xBits));

    double output = exponent * 0.69314718055994528623;
    x1 -= 3;

    double x2 = x1 * x1;
    double x4 = x2 * x2;
    double x6 = x2 * x4;
    double x8 = x4 * x4;
    double x10 = x6 * x4;
    double x12 = x6 * x6;

    output += taylorWeightsLn[0] + taylorWeightsLn[1] * x1;
    output += taylorWeightsLn[2] * x2 + taylorWeightsLn[3] * x2 * x1;
    output += taylorWeightsLn[4] * x4 + taylorWeightsLn[5] * x4 * x1;
    output += taylorWeightsLn[6] * x6 + taylorWeightsLn[7] * x6 * x1;
    output += taylorWeightsLn[8] * x8 + taylorWeightsLn[9] * x1 * x8;
    output += taylorWeightsLn[10] * x10 + taylorWeightsLn[11] * x1 * x10;
    output += taylorWeightsLn[12] * x12 + taylorWeightsLn[13] * x1 * x12;

    return (float) output;
}